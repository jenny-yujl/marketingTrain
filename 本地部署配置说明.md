# 本地部署后端地址配置

## 🔧 默认配置

- **后端服务器**: http://localhost:5000
- **前端开发服务器**: http://localhost:3000  
- **API访问地址**: http://localhost:3000/api/* (自动代理到后端)

## 📝 修改后端端口

### 1. 修改后端服务器端口

编辑 `server/local.ts` 第67行:
```typescript
const port = process.env.PORT || 5000;  // 改为您想要的端口
```

### 2. 修改前端代理配置

编辑 `vite.local.config.ts` 第22行:
```typescript
proxy: {
  "/api": {
    target: "http://localhost:5000",  // 改为您的后端地址
    changeOrigin: true,
  },
},
```

### 3. 使用环境变量

更灵活的方式是使用环境变量:

```bash
# 启动时指定端口
PORT=8080 node start-local.js

# 或者创建 .env 文件
echo "PORT=8080" > .env
```

## 🌍 外网访问配置

如果需要外网访问，修改 `server/local.ts`:

```typescript
server.listen(port, '0.0.0.0', () => {  // 允许外网访问
  console.log(`🚀 后端服务器启动成功 - http://0.0.0.0:${port}`);
});
```

## 🔍 验证后端服务器

启动后可以通过以下方式验证:

```bash
# 检查后端API
curl http://localhost:5000/api/campaigns

# 检查服务器状态
curl http://localhost:5000/health  # 如果有健康检查端点
```

## 📱 不同启动方式的地址

### 使用 start-local.js (推荐)
- 后端: http://localhost:5000
- 前端: http://localhost:3000
- 访问应用: http://localhost:3000

### 手动启动后端
```bash
npx tsx server/local.ts
# 后端地址: http://localhost:5000
```

### 手动启动前端
```bash
npx vite --config vite.local.config.ts --port 3000
# 前端地址: http://localhost:3000
```

## ⚠️ 注意事项

1. **端口冲突**: 确保5000和3000端口未被占用
2. **防火墙**: 如需外网访问，需要开放相应端口
3. **代理配置**: 修改后端端口时，必须同时修改前端代理配置

## 🛠️ 常用命令

```bash
# 查看端口占用
lsof -i :5000
lsof -i :3000

# 杀死占用进程
kill -9 <PID>

# 指定端口启动
PORT=8080 npx tsx server/local.ts
```